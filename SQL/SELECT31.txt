-- https://school.programmers.co.kr/learn/courses/30/lessons/301647

-- 코드를 작성해주세요
WITH P AS (
    SELECT ID, GENOTYPE FROM ECOLI_DATA
)

SELECT E.ID, E.GENOTYPE, P.GENOTYPE AS PARENT_GENOTYPE FROM ECOLI_DATA E
LEFT JOIN P ON P.ID = E.PARENT_ID
HAVING PARENT_GENOTYPE IS NOT NULL AND PARENT_GENOTYPE = (PARENT_GENOTYPE & E.GENOTYPE)
ORDER BY 1